# AI 音源分离方案架构设计 (Experimental)

本文档记录了关于引入 AI 音源分离（Audio Source Separation）的技术方案讨论、硬件决策及未来实施路线。

---

## 1. 核心目标
实现“音乐透明化”，通过 AI 将混成一团的音频拆分为独立声部（人声、鼓点、钢琴等），从而在视觉上实现不同乐器对应不同的烟火特效。

## 2. 技术决策

### 2.1 方案选型：异构计算与分布式部署
- **决策内容**：前端（React/Static Hosting）与 AI 计算后端（GPU Machine）分离。
- **理由**：
    - 浏览器端直接运行 AI 复杂度极高，且对普通用户设备压力巨大。
    - 将计算负载卸载到配备专用显卡的后端，可保证 10-20 秒内完成高品质解析。

### 2.2 模型选择：Demucs (Meta AI Research)
- **决策内容**：采用开源的 **Demucs v4** 模型（如 `htdemucs_ft`）。
- **理由**：
    - 完全开源，无单次解析费用。
    - 在 2026 年仍属于行业顶尖水平，人声与背景音分离最干净。
    - 能够直接输出 Vocals, Drums, Bass, Other 四条独立音轨。

### 2.3 硬件选型：RTX 4060 8G
- **决策内容**：在后端部署 RTX 4060 等级别的显卡。
- **理由**：
    - **显存**：8GB VRAM 足以容纳 Demucs 推理阶段（约 4GB）的开销。
    - **性能**：Ada Lovelace 架构能提供极快的计算速度，保证用户无需死等。

## 3. 架构流程 (Workflow)

1. **上传**：Web 前端通过 API 向后端提交 MP3 文件。
2. **异步任务**：后端 (FastAPI) 接收任务并放入队列，分发给 4060 显卡执行 `demucs` 推理。
3. **返回**：处理完成后，后端返回 4 个 Stem 文件的地址。
4. **渲染**：前端 `FireworkEngine` 同时驱动四个分析器，实现多声部视觉对齐。

## 4. 视觉映射规范 (未来预留)
- **人声 (Vocals)** -> 金色流光烟火。
- **鼓点 (Drums)** -> 高频红色爆发火花。
- **贝斯 (Bass)** -> 底部紫色震动场。
- **旋律 (Other)** -> 浮动音符粒子。

---
*注：本方案目前处于设计验证阶段，后续将启动 API 端点对接。*
